scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.8)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.9)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.2)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.5)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.6)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 1: PCA ordination plot of sites/ plots
# with plots colored by plant species richness
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3, alpha = 0.85)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species")) # manual legend
# Plot 1: PCA ordination plot of sites/ plots
# with plots colored by plant species richness
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3, alpha = 0.9)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species")) # manual legend
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "green")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.5)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "green", size = 3)
# Plot 1: PCA ordination plot of sites/ plots
# with plots colored by plant species richness
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3, alpha = 0.9)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species")) # manual legend
# Plot 2: PCA ordination plot of species
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "#8B3A3A")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "#8B3A3A", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "#8B3A3A")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.5)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "#8B3A3A", size = 3)
# set seed to obtain equal results each time of analysis
set.seed(2)
# fit environemntal data onto pca ordination
fit <- envfit(pca_spec ~ ., data = env_dat[, -1],
choices = 1:2, # axes to plotted
scaling = "symmetric",
permutations = 1000)
fit
# extract only significant p-values
env.scrs_sig <- as_tibble(scores(fit, display = "vectors")) %>% # extract scores
mutate(p.value = fit$vectors$pvals, # extract p-values
Env.variables = colnames(env_dat[2:6])) %>% # get variable names
subset(p.value<=0.05) # exclude non-significant variables
env.scrs_sig
# Plot 1: Only vectors of significant variables
ggplot(env.scrs_sig)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="black", lty =1) +
geom_vline(xintercept = 0, color="black", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "#008B45")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "#008B45")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "#008B45", size = 3)
# Plot 2: PCA ordination plot of species
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "#CD0000")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "#CD0000", size = 3)
# Plot 3: PCA ordination plot of species and plots
# with plots colored by plant species richness
ggplot(species.scrs)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "#CD0000")+
geom_point(data = site.scrs, aes(PC1, PC2, color = factor(Plant_SR)),
size = 3, alpha = 0.5)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2,label = species_name),
color = "#CD0000", size = 3)
# set seed to obtain equal results each time of analysis
set.seed(2)
# fit environemntal data onto pca ordination
fit <- envfit(pca_spec ~ ., data = env_dat[, -1],
choices = 1:2, # axes to plotted
scaling = "symmetric",
permutations = 1000)
fit
# extract only significant p-values
env.scrs_sig <- as_tibble(scores(fit, display = "vectors")) %>% # extract scores
mutate(p.value = fit$vectors$pvals, # extract p-values
Env.variables = colnames(env_dat[2:6])) %>% # get variable names
subset(p.value<=0.05) # exclude non-significant variables
env.scrs_sig
# Plot 1: Only vectors of significant variables
ggplot(env.scrs_sig)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2, label = Env.variables),
color = "black", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "#008B45")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "#008B45", size = 3)
# Plot 1: Only vectors of significant variables
ggplot(env.scrs_sig)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "black")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2, label = Env.variables),
color = "#008B45", size = 3)
# Plot 1: Only vectors of significant variables
ggplot(env.scrs_sig)+
geom_segment(aes(x = 0, y = 0, xend = PC1, yend = PC2), # arrows for environmental variables starting at 0
arrow = arrow(length = unit(0.2, "cm")), color = "#008B45")+
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+ # manual legend
geom_text_repel(aes(PC1, PC2, label = Env.variables),
color = "#008B45", size = 3)
# Plot 2: Samples and siginificant variables
ggplot(site.scrs)+
geom_point(aes(PC1, PC2, color = factor(Plant_SR)), size = 3)+
scale_color_viridis(option = "A", # color pallet with different options
discrete = TRUE)+
scale_fill_viridis(discrete = TRUE) +
geom_hline(yintercept = 0, color="grey", lty =1) +
geom_vline(xintercept = 0, color="grey", lty =1) +
geom_segment(data = env.scrs_sig,
aes(x = 0, y = 0, xend = PC1, yend = PC2),
arrow = arrow(length = unit(0.2, "cm")), color = "#008B45")+
theme_bw()+
labs(
x = "PC1 (33.69 %)",
y = "PC2 (24.74 %) ",
title = "PCA on Arthropod Composition along a Plant Species Richness Gradient",
subtitle = "Performed on the Hellinger-transformed species matrix")+
guides(color = guide_legend(title = "No. of Plant Species"))+
geom_text_repel(data = env.scrs_sig, aes(PC1, PC2, label = Env.variables),
color = "#008B45", size = 3)
